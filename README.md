This program was written to automatically generate customised practice material for my Chinese class.

The code is pretty poor, because all that matters is the output.

Unfortunately you can't actually run this program without some data files I can't really distribute.
